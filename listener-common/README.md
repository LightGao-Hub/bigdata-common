## listener-common介绍：

此模块是将Spark-Core中的事件监听总线 以及 事件池处理 这两种实现抽离出来并加以改造，可以供我们在其他项目中进行使用！



## 使用场景



### 1、事件监听总线

1.1、事件监听总线只适用于对状态管理并不重要的场景中，因为事件是存储在内存中会随着应用的结束而结束，如果用户希望保存状态则应该使用redis这类队列来应用。

1.2、事件监听总线适用于多种不同类型的监听器，和多种不同的事件，比方说一个应用中有多重监听器种类：job监听器，stage监听器，task监听器等等；此时可以用事件监听总线来统一进行调度和分发。

1.3、事件监听总线不仅可以存入事件，同时还可以存入监听器，也就是说一个事件总线中含有两种集合：事件集合、监听器集合。

1.4、实现事件监听总线的子类就是一个独立的事件监听总线。

1.5、需要注意的是事件监听总线最好是单例类，因为如果不是单例类，每new出一个监听总线就会创建出个队列和线程，增加系统负担。



### 2、事件池

2.1、事件池和上面的事件监听总线完全不同，事件池是单一功能，就是用来保存事件和处理事件，其内部只有一个事件队列，而不会存储监听器。

2.2、所有实现事件池的子类都相当于拥有一个事件队列，例如我有一个scheduler类，但是该类的处理函数速度较慢，此时为了不让上层阻塞，就可以继承事件池，将所有要处理的内容放入事件池，再不断调度处理即可！

2.3、事件池同时还可以作为异步处理框架，当外部请求进入到应用中时可以将其放入到事件池中后立刻返回，从而实现异步处理

2.4、需要注意的是实现事件池的类最好是单例类，因为如果不是单例类，那么每创建一个scheduler类就会再创建一个事件池，会增加系统的负担！



## 架构

![struct](https://tva1.sinaimg.cn/large/008vxvgGgy1h9lz6j3u6wj31lc0r6gqk.jpg)



![preview](https://tva1.sinaimg.cn/large/008vxvgGgy1h9lz6dj2bqj30vu0pa767.jpg)



